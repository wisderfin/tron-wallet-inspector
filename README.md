# Tron Wallet Inspector

Микросервис для получения информации о кошельках в сети Tron (TRX).

## Функциональность

Сервис предоставляет два основных эндпоинта:

1. `POST /` - Получение информации о кошельке
   - Принимает адрес кошелька
   - Возвращает информацию о bandwidth, energy и балансе TRX
   - Сохраняет запрос в базу данных

2. `GET /` - Получение истории запросов
   - Поддерживает пагинацию (параметры skip и limit)
   - Возвращает список последних запросов

## Технологии

- FastAPI - веб-фреймворк
- SQLAlchemy - ORM для работы с базой данных
- Tronpy - библиотека для взаимодействия с сетью Tron
- Pytest - фреймворк для тестирования
- PostgreSQL - база данных
- Docker & Docker Compose - контейнеризация

## Структура проекта

```
.
├── app/                    # Основной код приложения
│   ├── main.py            # Точка входа и эндпоинты
│   ├── crud.py            # CRUD операции с БД
│   ├── models.py          # SQLAlchemy модели
│   ├── schemas.py         # Pydantic схемы
│   └── tron_client.py     # Клиент для работы с Tron
├── tests/                 # Тесты
│   ├── test_api.py       # Интеграционные тесты
│   └── test_db.py        # Юнит-тесты
├── migrations/            # Миграции базы данных
├── requirements/          # Зависимости проекта
├── docker-compose.yaml    # Конфигурация Docker Compose
├── Dockerfile            # Конфигурация Docker
└── settings.py           # Настройки приложения
```

## Запуск проекта

Проект использует Makefile для упрощения работы с Docker. Доступные команды:

```bash
# Сборка и запуск контейнеров
make up

# Остановка контейнеров и очищение базы данных
make down

# Запуск тестов
make test

# Запуск миграций базы данных
make mgr msg="migration name"
```

### Запуск сервиса

1. Соберите и запустите контейнеры:
```bash
make up
```

2. Сервис будет доступен по адресу: http://localhost:8000

## API Документация

После запуска сервиса, документация API доступна по адресу:
- Swagger UI: http://localhost:8000/docs

## Примеры запросов

### Получение информации о кошельке
```bash
curl -X POST "http://localhost:8000/" \
     -H "Content-Type: application/json" \
     -d '{"address": "TRON_ADDRESS"}'
```

### Получение истории запросов
```bash
curl "http://localhost:8000/?skip=0&limit=10"
```

## Примечания

- Сервис использует переменные окружения для конфигурации (см. .env.example)
- Для работы с сетью Tron требуется настроить соответствующие параметры в .env файле
- Все запросы к API логируются в базу данных
- Реализована пагинация для GET запросов с параметрами skip и limit
